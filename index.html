<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UberFinance - Controle Financeiro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Tela de Login -->
    <div class="login-container" id="telaLogin">
        <div class="login-card">
            <div class="login-logo">
                <i class="bi bi-car-front"></i>
                <h2>UberFinance</h2>
                <p class="text-muted">Controle Financeiro</p>
            </div>

            <form class="login-form" id="formLogin">
                <div id="loginError" class="login-error" style="display: none;"></div>

                <div class="mb-3">
                    <label for="loginUsuario" class="form-label">Usuário</label>
                    <input type="text" class="form-control" id="loginUsuario" placeholder="Digite seu usuário" required>
                </div>

                <div class="mb-4">
                    <label for="loginSenha" class="form-label">Senha</label>
                    <input type="password" class="form-control" id="loginSenha" placeholder="Digite sua senha" required>
                </div>

                <button type="submit" class="login-btn">
                    <i class="bi bi-box-arrow-in-right"></i> Entrar
                </button>
            </form>
        </div>
    </div>

    <!-- Sistema Principal -->
    <div class="sistema-principal" id="sistemaPrincipal">
        <div class="container mt-4">
            <!-- Navbar Superior -->
            <nav class="navbar navbar-expand-lg navbar-dark mb-4" style="background: linear-gradient(45deg, #34495e, #2c3e50); border-radius: 15px;">
                <div class="container-fluid">
                    <a class="navbar-brand fw-bold" href="#"><i class="bi bi-car-front"></i> UberFinance</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item">
                                <a class="nav-link active text-white" onclick="mostrarAba('dashboard')" style="cursor: pointer;"><i class="bi bi-speedometer2"></i> Dashboard</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-white" onclick="mostrarAba('lancamentos')" style="cursor: pointer;"><i class="bi bi-plus-circle"></i> Lançar</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-white" onclick="mostrarAba('diario')" style="cursor: pointer;"><i class="bi bi-calendar-day"></i> Diário</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-white" onclick="mostrarAba('calendario')" style="cursor: pointer;"><i class="bi bi-calendar3"></i> Calendário</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-white" onclick="mostrarAba('configuracoes')" style="cursor: pointer;"><i class="bi bi-gear"></i> Configurações</a>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link text-white btn btn-link border-0 p-2" onclick="logout()" style="cursor: pointer;"><i class="bi bi-box-arrow-right"></i> Sair</button>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="tab-content">
                <!-- Dashboard -->
                <div class="tab-pane fade show active" id="dashboard">
                    <div class="row">
                        <div class="col-12">
                            <div class="meta-alert" id="metaAlert">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div>
                                        <i class="bi bi-target"></i> Meta para próximo dia de trabalho: R$ <span id="metaDiaria">0,00</span>
                                    </div>
                                    <span class="badge fs-6 p-2" id="statusMeta">Calculando...</span>
                                </div>
                                <small id="explicacaoMeta" class="d-block mt-2 opacity-75">Carregando explicação...</small>
                            </div>
                        </div>

                        <div class="col-12 mb-3">
                            <div class="card card-custom">
                                <div class="card-header bg-transparent">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h5><i class="bi bi-speedometer2"></i> Dashboard Financeiro</h5>
                                        <select class="form-select w-auto" id="mesDashboard" onchange="atualizarDashboard()">
                                            <option value="">Selecione o mês...</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-wallet2"></i> Saldo Atual</h5>
                                <h2 id="saldoAtual">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-piggy-bank"></i> Lucro Líquido</h5>
                                <h2 id="lucroLiquido">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-calendar-month"></i> Faturamento Mês</h5>
                                <h2 id="faturamentoMes">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-speedometer"></i> Custo por Km</h5>
                                <h2 id="custoPorKm">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-geo-alt"></i> Total Km Mês</h5>
                                <h2 id="totalKmMes">0 km</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-fuel-pump"></i> Gasto Gasolina</h5>
                                <h2 id="gastoGasolina">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card">
                                <h5><i class="bi bi-receipt"></i> Outros Gastos</h5>
                                <h2 id="outrosGastos">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
                                <h5><i class="bi bi-exclamation-triangle"></i> Contas Vencidas</h5>
                                <h2 id="contasVencidas">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-md-6 col-12">
                            <div class="dashboard-card" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);">
                                <h5><i class="bi bi-shield-check"></i> Reserva de Emergência</h5>
                                <h2 id="saldoReserva">R$ 0,00</h2>
                            </div>
                        </div>

                        <div class="col-12" id="alertaAtrasadas" style="display: none;">
                            <div class="alert alert-danger">
                                <h6><i class="bi bi-exclamation-triangle-fill"></i> Atenção! Contas em Atraso</h6>
                                <div id="listaAtrasadas"></div>
                            </div>
                        </div>

                        <!-- Relatório Detalhado -->
                        <div class="col-12" id="relatorioDetalhado">
                            <div class="card card-custom">
                                <div class="card-header bg-transparent">
                                    <h6><i class="bi bi-graph-up"></i> Relatório Detalhado</h6>
                                </div>
                                <div class="card-body">
                                    <div id="relatorioContent">
                                        <div class="text-center text-muted">
                                            <i class="bi bi-bar-chart fs-1"></i>
                                            <p>Selecione um mês para ver o relatório detalhado</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lançamentos -->
                <div class="tab-pane fade" id="lancamentos">
                    <div class="card card-custom">
                        <div class="card-header bg-transparent">
                            <h5><i class="bi bi-plus-circle"></i> Lançar Conta</h5>
                        </div>
                        <div class="card-body">
                            <form id="formConta">
                                <div class="mb-3">
                                    <label class="form-label">Tipo</label>
                                    <select class="form-select" id="tipoConta" required>
                                        <option value="">Selecione...</option>
                                        <option value="pagar">Conta a Pagar</option>
                                        <option value="receber">Conta a Receber</option>
                                        <option value="gasto">Gasto Realizado</option>
                                        <option value="reserva_entrada">Reserva - Entrada (Guardar dinheiro)</option>
                                        <option value="reserva_saida">Reserva - Saída (Usar reserva)</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Descrição</label>
                                    <input type="text" class="form-control" id="descricaoConta" required>
                                </div>

                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">Valor (R$)</label>
                                        <input type="number" class="form-control" id="valorConta" step="0.01" required>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Data</label>
                                        <input type="date" class="form-control" id="dataConta" required>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary-custom w-100 mt-3">
                                    <i class="bi bi-check-circle"></i> Lançar Conta
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Diário Uber -->
                <div class="tab-pane fade" id="diario">
                    <div class="card card-custom">
                        <div class="card-header bg-transparent">
                            <h5><i class="bi bi-calendar-day"></i> Registro Diário</h5>
                        </div>
                        <div class="card-body">
                            <form id="formDiario">
                                <div class="mb-3">
                                    <label class="form-label">Data</label>
                                    <input type="date" class="form-control" id="dataDiario" required>
                                </div>

                                <div class="row">
                                    <div class="col-md-4 col-6">
                                        <label class="form-label">Faturamento Uber (R$)</label>
                                        <input type="number" class="form-control" id="faturamentoDiario" step="0.01" required>
                                    </div>
                                    <div class="col-md-4 col-6">
                                        <label class="form-label">Gasto Gasolina (R$)</label>
                                        <input type="number" class="form-control" id="gasolinaDiario" step="0.01" required>
                                    </div>
                                    <div class="col-md-4 col-12">
                                        <label class="form-label">Km Rodados</label>
                                        <input type="number" class="form-control" id="kmRodados" step="0.1" required>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Observações</label>
                                    <textarea class="form-control" id="observacoesDiario" rows="3"></textarea>
                                </div>

                                <button type="submit" class="btn btn-primary-custom w-100">
                                    <i class="bi bi-save"></i> Salvar Registro
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Histórico Diário -->
                    <div class="card card-custom">
                        <div class="card-header bg-transparent">
                            <h6>Últimos Registros</h6>
                        </div>
                        <div class="card-body">
                            <div id="historicoDiario"></div>
                        </div>
                    </div>
                </div>

                <!-- Calendário -->
                <div class="tab-pane fade" id="calendario">
                    <div class="card card-custom">
                        <div class="card-header bg-transparent d-flex justify-content-between align-items-center">
                            <button class="btn btn-outline-primary" onclick="mudarMes(-1)">
                                <i class="bi bi-chevron-left"></i>
                            </button>
                            <h5 id="mesAnoCalendario"></h5>
                            <button class="btn btn-outline-primary" onclick="mudarMes(1)">
                                <i class="bi bi-chevron-right"></i>
                            </button>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-bordered mb-0">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="text-center">Dom</th>
                                            <th class="text-center">Seg</th>
                                            <th class="text-center">Ter</th>
                                            <th class="text-center">Qua</th>
                                            <th class="text-center">Qui</th>
                                            <th class="text-center">Sex</th>
                                            <th class="text-center">Sáb</th>
                                        </tr>
                                    </thead>
                                    <tbody id="calendarioBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Lista de Contas do Dia -->
                    <div class="card card-custom" id="contasDoDia" style="display: none;">
                        <div class="card-header bg-transparent">
                            <h6><i class="bi bi-calendar-check"></i> Contas do Dia <span id="dataSelecionada"></span></h6>
                        </div>
                        <div class="card-body">
                            <div id="listaContasDia"></div>
                        </div>
                    </div>
                </div>

                <!-- Configurações -->
                <div class="tab-pane fade" id="configuracoes">
                    <div class="card card-custom">
                        <div class="card-header bg-transparent">
                            <h5><i class="bi bi-gear"></i> Configurações do Sistema</h5>
                        </div>
                        <div class="card-body">
                            <form id="formConfiguracoes">
                                <div class="mb-4">
                                    <h6><i class="bi bi-target"></i> Meta Diária</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Valor mínimo por dia de trabalho (R$)</label>
                                        <input type="number" class="form-control" id="metaDiariaMinima" step="0.01" placeholder="Ex: 150.00">
                                        <small class="text-muted">Este valor será usado para calcular sua meta mensal baseada nos dias de trabalho</small>
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <h6><i class="bi bi-calendar-week"></i> Dias de Trabalho</h6>
                                    <p class="text-muted mb-3">Selecione os dias da semana que você trabalha regularmente (para cálculo da meta mensal)</p>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="domingo" value="0">
                                                <label class="form-check-label" for="domingo">Domingo</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="segunda" value="1">
                                                <label class="form-check-label" for="segunda">Segunda-feira</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="terca" value="2">
                                                <label class="form-check-label" for="terca">Terça-feira</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="quarta" value="3">
                                                <label class="form-check-label" for="quarta">Quarta-feira</label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="quinta" value="4">
                                                <label class="form-check-label" for="quinta">Quinta-feira</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="sexta" value="5">
                                                <label class="form-check-label" for="sexta">Sexta-feira</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="sabado" value="6">
                                                <label class="form-check-label" for="sabado">Sábado</label>
                                            </div>
                                        </div>
                                    </div>
                                    <small class="text-muted">Dias não marcados serão considerados folga. Faturamento em dias de folga conta como extra!</small>
                                </div>

                                <button type="submit" class="btn btn-primary-custom w-100">
                                    <i class="bi bi-save"></i> Salvar Configurações
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Alteração de Senha -->
                    <div class="card card-custom">
                        <div class="card-header bg-transparent">
                            <h5><i class="bi bi-shield-lock"></i> Alterar Senha</h5>
                        </div>
                        <div class="card-body">
                            <form id="formAlterarSenha">
                                <div class="mb-3">
                                    <label class="form-label">Senha Atual</label>
                                    <input type="password" class="form-control" id="senhaAtual" required>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Nova Senha</label>
                                    <input type="password" class="form-control" id="novaSenha" required minlength="6">
                                    <small class="text-muted">Mínimo 6 caracteres</small>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Confirmar Nova Senha</label>
                                    <input type="password" class="form-control" id="confirmarSenha" required>
                                </div>

                                <button type="submit" class="btn btn-warning w-100">
                                    <i class="bi bi-key"></i> Alterar Senha
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Resumo das Configurações -->
                    <div class="card card-custom">
                        <div class="card-header bg-transparent">
                            <h6><i class="bi bi-info-circle"></i> Resumo das Configurações</h6>
                        </div>
                        <div class="card-body">
                            <div id="resumoConfiguracoes">
                                <p class="text-muted">Configure suas metas e dias de trabalho para ver o resumo aqui.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Modais Customizados -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-custom">
            <div class="modal-header-custom">
                <div class="modal-icon" id="modalIcon"></div>
                <h5 id="modalTitle">Título</h5>
            </div>
            <div class="modal-body-custom">
                <p id="modalMessage">Mensagem</p>
            </div>
            <div class="modal-footer-custom" id="modalFooter">
                <!-- Botões serão inseridos dinamicamente -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="service.js"></script>
</body>

</html>